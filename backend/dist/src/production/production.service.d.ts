import { DittofeedService } from '../dittofeed/dittofeed.service';
import { PrismaService } from '../prisma/prisma.service';
type ProductionStatusType = 'QUEUED' | 'PREPRESS' | 'PRINTING' | 'CURING' | 'CUTTING' | 'QC_CHECK' | 'PACKAGING' | 'READY' | 'PICKED_UP' | 'SHIPPED' | 'COMPLETED' | 'CANCELLED';
interface CreateJobInput {
    merchantId: string;
    orderId: string;
    designProjectId?: string;
    widthInch: number;
    heightInch: number;
    productType: string;
    quantity?: number;
    designFileUrl?: string;
    dpi?: number;
    priority?: 'STANDARD' | 'RUSH' | 'SAME_DAY' | 'NEXT_DAY';
    notes?: string;
}
export interface KanbanBoard {
    QUEUED: any[];
    PREPRESS: any[];
    PRINTING: any[];
    CURING: any[];
    CUTTING: any[];
    QC_CHECK: any[];
    PACKAGING: any[];
    READY: any[];
    PICKED_UP: any[];
    SHIPPED: any[];
    COMPLETED: any[];
    CANCELLED: any[];
}
export interface ProductionStats {
    totalJobs: number;
    byStatus: Record<string, number>;
    todayCompleted: number;
    todaySqft: number;
    avgTurnaroundHours: number;
    rushJobs: number;
    delayedJobs: number;
}
export declare class ProductionService {
    private readonly prisma;
    private readonly dittofeedService;
    private readonly logger;
    constructor(prisma: PrismaService, dittofeedService: DittofeedService);
    createJob(input: CreateJobInput): Promise<{
        order: {
            email: string | null;
            companyUserId: string | null;
            shopifyOrderNumber: string | null;
        };
    } & {
        id: string;
        status: import("@prisma/client/client").$Enums.ProductionStatus;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        productType: string;
        notes: string | null;
        priority: import("@prisma/client/client").$Enums.ProductionPriority;
        metadata: import("@prisma/client/runtime/client").JsonValue | null;
        completedAt: Date | null;
        orderId: string;
        quantity: number;
        readyAt: Date | null;
        designProjectId: string | null;
        printerId: string | null;
        operatorId: string | null;
        operatorName: string | null;
        gangSheetBatchId: string | null;
        gangSheetPosition: number | null;
        widthInch: number;
        heightInch: number;
        areaSquareInch: number | null;
        designFileUrl: string | null;
        dpi: number | null;
        dpiValidated: boolean;
        qcNotes: string | null;
        qcResult: string | null;
        queuedAt: Date;
        prepressStartAt: Date | null;
        printStartAt: Date | null;
        cureStartAt: Date | null;
        cutStartAt: Date | null;
        qcStartAt: Date | null;
        qcPassAt: Date | null;
        packagingStartAt: Date | null;
        estimatedPrintMinutes: number | null;
        estimatedReadyAt: Date | null;
    }>;
    createJobsFromOrder(merchantId: string, orderId: string): Promise<{
        created: number;
        jobs: any[];
    }>;
    moveToStatus(jobId: string, newStatus: ProductionStatusType, operatorName?: string): Promise<{
        printer: {
            name: string;
        } | null;
        order: {
            email: string | null;
            companyUserId: string | null;
            shopifyOrderNumber: string | null;
        };
    } & {
        id: string;
        status: import("@prisma/client/client").$Enums.ProductionStatus;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        productType: string;
        notes: string | null;
        priority: import("@prisma/client/client").$Enums.ProductionPriority;
        metadata: import("@prisma/client/runtime/client").JsonValue | null;
        completedAt: Date | null;
        orderId: string;
        quantity: number;
        readyAt: Date | null;
        designProjectId: string | null;
        printerId: string | null;
        operatorId: string | null;
        operatorName: string | null;
        gangSheetBatchId: string | null;
        gangSheetPosition: number | null;
        widthInch: number;
        heightInch: number;
        areaSquareInch: number | null;
        designFileUrl: string | null;
        dpi: number | null;
        dpiValidated: boolean;
        qcNotes: string | null;
        qcResult: string | null;
        queuedAt: Date;
        prepressStartAt: Date | null;
        printStartAt: Date | null;
        cureStartAt: Date | null;
        cutStartAt: Date | null;
        qcStartAt: Date | null;
        qcPassAt: Date | null;
        packagingStartAt: Date | null;
        estimatedPrintMinutes: number | null;
        estimatedReadyAt: Date | null;
    }>;
    batchMoveToStatus(jobIds: string[], newStatus: ProductionStatusType, operatorName?: string): Promise<{
        succeeded: number;
        failed: number;
        results: {
            id: string;
            success: boolean;
            error?: string;
        }[];
    }>;
    getKanbanBoard(merchantId: string): Promise<KanbanBoard>;
    getPrinters(merchantId: string): Promise<({
        jobs: {
            id: string;
            status: import("@prisma/client/client").$Enums.ProductionStatus;
            productType: string;
            estimatedPrintMinutes: number | null;
        }[];
    } & {
        model: string;
        name: string;
        id: string;
        status: import("@prisma/client/client").$Enums.PrinterStatus;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        maxWidthInch: number;
        inkCyan: number | null;
        inkMagenta: number | null;
        inkYellow: number | null;
        inkBlack: number | null;
        inkWhite: number | null;
        supportedTypes: string[];
        totalPrintsToday: number;
        totalPrintsAll: number;
        totalSqftToday: number;
        totalSqftAll: number;
        lastMaintenanceAt: Date | null;
        nextMaintenanceAt: Date | null;
        maintenanceNotes: string | null;
        location: string | null;
    })[]>;
    createPrinter(merchantId: string, data: {
        name: string;
        model: string;
        maxWidthInch: number;
        supportedTypes?: string[];
        location?: string;
    }): Promise<{
        model: string;
        name: string;
        id: string;
        status: import("@prisma/client/client").$Enums.PrinterStatus;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        maxWidthInch: number;
        inkCyan: number | null;
        inkMagenta: number | null;
        inkYellow: number | null;
        inkBlack: number | null;
        inkWhite: number | null;
        supportedTypes: string[];
        totalPrintsToday: number;
        totalPrintsAll: number;
        totalSqftToday: number;
        totalSqftAll: number;
        lastMaintenanceAt: Date | null;
        nextMaintenanceAt: Date | null;
        maintenanceNotes: string | null;
        location: string | null;
    }>;
    updateInkLevels(printerId: string, levels: {
        cyan?: number;
        magenta?: number;
        yellow?: number;
        black?: number;
        white?: number;
    }): Promise<{
        model: string;
        name: string;
        id: string;
        status: import("@prisma/client/client").$Enums.PrinterStatus;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        maxWidthInch: number;
        inkCyan: number | null;
        inkMagenta: number | null;
        inkYellow: number | null;
        inkBlack: number | null;
        inkWhite: number | null;
        supportedTypes: string[];
        totalPrintsToday: number;
        totalPrintsAll: number;
        totalSqftToday: number;
        totalSqftAll: number;
        lastMaintenanceAt: Date | null;
        nextMaintenanceAt: Date | null;
        maintenanceNotes: string | null;
        location: string | null;
    }>;
    updatePrinterStatus(printerId: string, status: 'IDLE' | 'PRINTING' | 'MAINTENANCE' | 'OFFLINE', notes?: string): Promise<{
        model: string;
        name: string;
        id: string;
        status: import("@prisma/client/client").$Enums.PrinterStatus;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        maxWidthInch: number;
        inkCyan: number | null;
        inkMagenta: number | null;
        inkYellow: number | null;
        inkBlack: number | null;
        inkWhite: number | null;
        supportedTypes: string[];
        totalPrintsToday: number;
        totalPrintsAll: number;
        totalSqftToday: number;
        totalSqftAll: number;
        lastMaintenanceAt: Date | null;
        nextMaintenanceAt: Date | null;
        maintenanceNotes: string | null;
        location: string | null;
    }>;
    assignToPrinter(jobId: string, printerId: string): Promise<{
        id: string;
        status: import("@prisma/client/client").$Enums.ProductionStatus;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        productType: string;
        notes: string | null;
        priority: import("@prisma/client/client").$Enums.ProductionPriority;
        metadata: import("@prisma/client/runtime/client").JsonValue | null;
        completedAt: Date | null;
        orderId: string;
        quantity: number;
        readyAt: Date | null;
        designProjectId: string | null;
        printerId: string | null;
        operatorId: string | null;
        operatorName: string | null;
        gangSheetBatchId: string | null;
        gangSheetPosition: number | null;
        widthInch: number;
        heightInch: number;
        areaSquareInch: number | null;
        designFileUrl: string | null;
        dpi: number | null;
        dpiValidated: boolean;
        qcNotes: string | null;
        qcResult: string | null;
        queuedAt: Date;
        prepressStartAt: Date | null;
        printStartAt: Date | null;
        cureStartAt: Date | null;
        cutStartAt: Date | null;
        qcStartAt: Date | null;
        qcPassAt: Date | null;
        packagingStartAt: Date | null;
        estimatedPrintMinutes: number | null;
        estimatedReadyAt: Date | null;
    }>;
    createGangSheetBatch(merchantId: string, data: {
        sheetWidth: number;
        sheetHeight: number;
        jobIds: string[];
    }): Promise<{
        jobCount: number;
        id: string;
        status: string;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        sheetWidth: number;
        sheetHeight: number;
        fillRate: number;
        usedArea: number;
        totalArea: number;
        wasteArea: number;
        isMultiOrder: boolean;
        orderCount: number;
    }>;
    getGangSheetBatches(merchantId: string, status?: string): Promise<({
        jobs: {
            id: string;
            productType: string;
            orderId: string;
            gangSheetPosition: number | null;
            widthInch: number;
            heightInch: number;
            areaSquareInch: number | null;
            order: {
                shopifyOrderNumber: string | null;
            };
        }[];
    } & {
        id: string;
        status: string;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        sheetWidth: number;
        sheetHeight: number;
        fillRate: number;
        usedArea: number;
        totalArea: number;
        wasteArea: number;
        isMultiOrder: boolean;
        orderCount: number;
    })[]>;
    getBatchRecommendations(merchantId: string): Promise<any[]>;
    getLabelData(jobId: string): Promise<{
        labelId: string;
        orderNumber: any;
        customer: any;
        productType: string;
        dimensions: string;
        printer: string;
        qrCodeContent: string;
        packagingDate: string;
        priority: import("@prisma/client/client").$Enums.ProductionPriority;
    }>;
    checkProductionSLAs(): Promise<void>;
    getStats(merchantId: string): Promise<ProductionStats>;
    getPrinterStats(merchantId: string): Promise<{
        id: string;
        name: string;
        model: string;
        status: import("@prisma/client/client").$Enums.PrinterStatus;
        inkLevels: {
            cyan: number | null;
            magenta: number | null;
            yellow: number | null;
            black: number | null;
            white: number | null;
        };
        totalJobsCompleted: number;
        totalSqft: number;
        avgPrintTimeMinutes: number;
    }[]>;
    recordQcResult(jobId: string, result: 'pass' | 'fail' | 'conditional', notes?: string): Promise<{
        id: string;
        status: import("@prisma/client/client").$Enums.ProductionStatus;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        productType: string;
        notes: string | null;
        priority: import("@prisma/client/client").$Enums.ProductionPriority;
        metadata: import("@prisma/client/runtime/client").JsonValue | null;
        completedAt: Date | null;
        orderId: string;
        quantity: number;
        readyAt: Date | null;
        designProjectId: string | null;
        printerId: string | null;
        operatorId: string | null;
        operatorName: string | null;
        gangSheetBatchId: string | null;
        gangSheetPosition: number | null;
        widthInch: number;
        heightInch: number;
        areaSquareInch: number | null;
        designFileUrl: string | null;
        dpi: number | null;
        dpiValidated: boolean;
        qcNotes: string | null;
        qcResult: string | null;
        queuedAt: Date;
        prepressStartAt: Date | null;
        printStartAt: Date | null;
        cureStartAt: Date | null;
        cutStartAt: Date | null;
        qcStartAt: Date | null;
        qcPassAt: Date | null;
        packagingStartAt: Date | null;
        estimatedPrintMinutes: number | null;
        estimatedReadyAt: Date | null;
    }>;
    resetDailyPrinterStats(): Promise<void>;
    calculateConsumption(jobId: string): Promise<{
        estimatedInkMl: number;
        estimatedFilmSqFt: number;
        estimatedPowderGr: number;
    } | null>;
    private parseDimensions;
    private detectProductType;
    private sendProductionEvent;
    private mapStatusToEventName;
    logEnvironment(merchantId: string, data: {
        temperature: number;
        humidity: number;
        location?: string;
    }): Promise<{
        id: string;
        merchantId: string;
        location: string | null;
        temperature: number;
        humidity: number;
        recordedAt: Date;
    }>;
    recordMaintenance(data: {
        printerId: string;
        operatorName: string;
        type: string;
        notes?: string;
    }): Promise<{
        id: string;
        createdAt: Date;
        notes: string | null;
        printerId: string;
        operatorName: string;
        maintenanceType: string;
    }>;
    getMaintenanceHistory(printerId: string): Promise<{
        id: string;
        createdAt: Date;
        notes: string | null;
        printerId: string;
        operatorName: string;
        maintenanceType: string;
    }[]>;
    getRollNestingProposal(merchantId: string, printableWidth?: number): Promise<{
        suggestedRollWidth: number;
        totalDesignCount: number;
        requiredRollLengthInch: number;
        estimatedFilmCost: number;
        jobIds: any[];
    } | null>;
    getPackagingStrategy(orderId: string): Promise<{
        orderId: string;
        recommendedPackaging: string;
        shippingNote: string;
        addSilicaPacket: boolean;
        mandatoryInstructions: string[];
    }>;
}
export {};
