import { Prisma } from '@prisma/client';
import { DittofeedService } from '../dittofeed/dittofeed.service';
import { PrismaService } from '../prisma/prisma.service';
export declare class CustomerIntelligenceService {
    private prisma;
    private dittofeed;
    private readonly logger;
    constructor(prisma: PrismaService, dittofeed: DittofeedService);
    calculateInsights(merchantId: string): Promise<{
        processed: number;
    }>;
    private calculateCustomerInsight;
    private calculateDeepMetrics;
    private getLifecycleStage;
    private getReactivationPotential;
    private getEngagementVelocity;
    private detectSeasonalBuyer;
    private calculateSeasonalityScore;
    private calculateProductPairs;
    private getCustomerPercentile;
    private median;
    private getRFMSegment;
    private calculateHealthScore;
    private getChurnRisk;
    private getCLVTier;
    private getPurchaseFrequency;
    private getOrderTrend;
    private extractPreferredCategories;
    private extractPreferredVendors;
    private calculateQuintiles;
    private getQuintileScore;
    getInsightsSummary(merchantId: string): Promise<{
        totalCustomers: number;
        analyzedCustomers: number;
        returningCustomerRate: string | number;
        averageClv: string | number;
        averageHealthScore: number;
        segmentDistribution: {
            [k: string]: number;
        };
        tierDistribution: {
            [k: string]: number;
        };
        riskDistribution: {
            [k: string]: number;
        };
        topChampions: number;
        atRiskCount: number;
    }>;
    getCustomerWithInsight(customerId: string): Promise<({
        insight: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            shopifyCustomerId: string;
            lastOrderAt: Date | null;
            avgOrderValue: Prisma.Decimal | null;
            firstOrderAt: Date | null;
            daysSinceLastOrder: number | null;
            churnRisk: string | null;
            clvScore: Prisma.Decimal | null;
            projectedClv: Prisma.Decimal | null;
            clvTier: string | null;
            rfmRecency: number | null;
            rfmFrequency: number | null;
            rfmMonetary: number | null;
            rfmSegment: string | null;
            healthScore: number | null;
            avgDaysBetweenOrders: number | null;
            purchaseFrequency: string | null;
            preferredCategories: Prisma.JsonValue | null;
            preferredVendors: Prisma.JsonValue | null;
            maxOrderValue: Prisma.Decimal | null;
            orderTrend: string | null;
            customerSince: Date | null;
            isReturning: boolean;
            deepMetrics: Prisma.JsonValue | null;
            calculatedAt: Date;
        } | null;
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        shopifyCustomerId: bigint;
        email: string | null;
        firstName: string | null;
        lastName: string | null;
        phone: string | null;
        addresses: Prisma.JsonValue | null;
        tags: string | null;
        note: string | null;
        totalSpent: Prisma.Decimal | null;
        ordersCount: number;
        rawData: Prisma.JsonValue | null;
        verifiedEmail: boolean | null;
        acceptsMarketing: boolean | null;
        marketingOptInLevel: string | null;
        taxExempt: boolean | null;
        state: string | null;
        currency: string | null;
        locale: string | null;
        lastOrderId: bigint | null;
        lastOrderAt: Date | null;
        averageOrderValue: Prisma.Decimal | null;
        metafields: Prisma.JsonValue | null;
        syncedAt: Date;
    }) | null>;
    getCustomersBySegment(merchantId: string, segment: string, limit?: number): Promise<({
        insight: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            shopifyCustomerId: string;
            lastOrderAt: Date | null;
            avgOrderValue: Prisma.Decimal | null;
            firstOrderAt: Date | null;
            daysSinceLastOrder: number | null;
            churnRisk: string | null;
            clvScore: Prisma.Decimal | null;
            projectedClv: Prisma.Decimal | null;
            clvTier: string | null;
            rfmRecency: number | null;
            rfmFrequency: number | null;
            rfmMonetary: number | null;
            rfmSegment: string | null;
            healthScore: number | null;
            avgDaysBetweenOrders: number | null;
            purchaseFrequency: string | null;
            preferredCategories: Prisma.JsonValue | null;
            preferredVendors: Prisma.JsonValue | null;
            maxOrderValue: Prisma.Decimal | null;
            orderTrend: string | null;
            customerSince: Date | null;
            isReturning: boolean;
            deepMetrics: Prisma.JsonValue | null;
            calculatedAt: Date;
        } | null;
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        shopifyCustomerId: bigint;
        email: string | null;
        firstName: string | null;
        lastName: string | null;
        phone: string | null;
        addresses: Prisma.JsonValue | null;
        tags: string | null;
        note: string | null;
        totalSpent: Prisma.Decimal | null;
        ordersCount: number;
        rawData: Prisma.JsonValue | null;
        verifiedEmail: boolean | null;
        acceptsMarketing: boolean | null;
        marketingOptInLevel: string | null;
        taxExempt: boolean | null;
        state: string | null;
        currency: string | null;
        locale: string | null;
        lastOrderId: bigint | null;
        lastOrderAt: Date | null;
        averageOrderValue: Prisma.Decimal | null;
        metafields: Prisma.JsonValue | null;
        syncedAt: Date;
    })[]>;
    getAtRiskCustomers(merchantId: string, limit?: number): Promise<({
        insight: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            shopifyCustomerId: string;
            lastOrderAt: Date | null;
            avgOrderValue: Prisma.Decimal | null;
            firstOrderAt: Date | null;
            daysSinceLastOrder: number | null;
            churnRisk: string | null;
            clvScore: Prisma.Decimal | null;
            projectedClv: Prisma.Decimal | null;
            clvTier: string | null;
            rfmRecency: number | null;
            rfmFrequency: number | null;
            rfmMonetary: number | null;
            rfmSegment: string | null;
            healthScore: number | null;
            avgDaysBetweenOrders: number | null;
            purchaseFrequency: string | null;
            preferredCategories: Prisma.JsonValue | null;
            preferredVendors: Prisma.JsonValue | null;
            maxOrderValue: Prisma.Decimal | null;
            orderTrend: string | null;
            customerSince: Date | null;
            isReturning: boolean;
            deepMetrics: Prisma.JsonValue | null;
            calculatedAt: Date;
        } | null;
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        merchantId: string;
        shopifyCustomerId: bigint;
        email: string | null;
        firstName: string | null;
        lastName: string | null;
        phone: string | null;
        addresses: Prisma.JsonValue | null;
        tags: string | null;
        note: string | null;
        totalSpent: Prisma.Decimal | null;
        ordersCount: number;
        rawData: Prisma.JsonValue | null;
        verifiedEmail: boolean | null;
        acceptsMarketing: boolean | null;
        marketingOptInLevel: string | null;
        taxExempt: boolean | null;
        state: string | null;
        currency: string | null;
        locale: string | null;
        lastOrderId: bigint | null;
        lastOrderAt: Date | null;
        averageOrderValue: Prisma.Decimal | null;
        metafields: Prisma.JsonValue | null;
        syncedAt: Date;
    })[]>;
    syncInsightsToDittofeed(merchantId: string): Promise<{
        synced: number;
    }>;
}
